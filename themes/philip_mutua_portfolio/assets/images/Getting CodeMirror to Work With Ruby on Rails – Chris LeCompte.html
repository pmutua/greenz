<!DOCTYPE html>
<html lang="en-US"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="apple-touch-icon" sizes="180x180" href="http://clecompte.com/wp-content/themes/cl/resources/assets/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="http://clecompte.com/wp-content/themes/cl/resources/assets/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="http://clecompte.com/wp-content/themes/cl/resources/assets/images/favicon-16x16.png">
  <title>Getting CodeMirror to Work With Ruby on Rails – Chris LeCompte</title>
<link rel="dns-prefetch" href="http://s.w.org/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/clecompte.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.8"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b===c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="Getting%20CodeMirror%20to%20Work%20With%20Ruby%20on%20Rails%20%E2%80%93%20Chris%20LeCompte_files/wp-emoji-release.js" type="text/javascript" defer="defer"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="sage/main.css-css" href="Getting%20CodeMirror%20to%20Work%20With%20Ruby%20on%20Rails%20%E2%80%93%20Chris%20LeCompte_files/main_8eaed8b2.css" type="text/css" media="all">
<script type="text/javascript" src="Getting%20CodeMirror%20to%20Work%20With%20Ruby%20on%20Rails%20%E2%80%93%20Chris%20LeCompte_files/jquery.js"></script>
<script type="text/javascript" src="Getting%20CodeMirror%20to%20Work%20With%20Ruby%20on%20Rails%20%E2%80%93%20Chris%20LeCompte_files/jquery-migrate.js"></script>
<link rel="https://api.w.org/" href="http://clecompte.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://clecompte.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://clecompte.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Boosting Customer Retention in an Increasingly Service-Oriented Marketplace" href="http://clecompte.com/boosting-customer-retention/">
<link rel="next" title="Making Email Testing Easier with Grunt.js, Mailgun and Amazon S3" href="http://clecompte.com/email-testing-with-grunt-js-mailgun-amazon-s3/">
<meta name="generator" content="WordPress 4.8">
<link rel="canonical" href="http://clecompte.com/codemirror-ruby-rails/">
<link rel="shortlink" href="http://clecompte.com/?p=1724">
<link rel="alternate" type="application/json+oembed" href="http://clecompte.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fclecompte.com%2Fcodemirror-ruby-rails%2F">
<link rel="alternate" type="text/xml+oembed" href="http://clecompte.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fclecompte.com%2Fcodemirror-ruby-rails%2F&amp;format=xml">
</head>
  <body class="post-template-default single single-post postid-1724 single-format-standard codemirror-ruby-rails" cz-shortcut-listen="true">
          <section class="header">
  <div class="header-logo">
    <a href="http://clecompte.com/"><img alt="Chris LeCompte" src="Getting%20CodeMirror%20to%20Work%20With%20Ruby%20on%20Rails%20%E2%80%93%20Chris%20LeCompte_files/logo.svg" width="70"></a>
  </div>
</section>        <div class="wrap container" role="document">
        <main class="main">
                 <article class="post_full">
  <header>
    <h1 class="post_full-title">Getting CodeMirror to Work With Ruby on Rails</h1>
    <div class="post_full-meta">
      <time class="updated" datetime="2014-07-19T18:14:08+00:00">July 19, 2014</time>    </div>
  </header>
    <div class="post_full-content">
    <p><img class="alignright  wp-image-1731" src="Getting%20CodeMirror%20to%20Work%20With%20Ruby%20on%20Rails%20%E2%80%93%20Chris%20LeCompte_files/codemirror.png" alt="codemirror" srcset="http://clecompte.com/wp-content/uploads/2014/07/codemirror.png 525w, http://clecompte.com/wp-content/uploads/2014/07/codemirror-300x116.png 300w, http://clecompte.com/wp-content/uploads/2014/07/codemirror-130x50.png 130w" sizes="(max-width: 429px) 100vw, 429px" width="429" height="166">I’m
 in the process of building a pattern library at my current job. Keeping
 with the culture of the company, I’m building the library on Rails, 
using Sass and Haml to expedite the code writing. Part of the library 
needs to show code snippets, so to do this, I needed pretty output for 
the Haml source code I wanted to show. Basically, I didn’t want to 
settle for outputting code using &lt;pre&gt; and &lt;code&gt;.</p>
<p>Enter <a href="http://codemirror.net/">CodeMirror</a>. CodeMirror is 
an in-browser editor that enables you to display source code 
with&nbsp;much of the power and theming capabilities of a full-blown 
editor. For my purposes, I just want it to show code coloring and line 
numbers.<span id="more-1724"></span></p>
<p>Integrating CodeMirror with a Rails application is a fairly painless process. Fortunately, there’s a <a href="https://github.com/fixlr/codemirror-rails">gem in existence</a>. Install the gem or add it to your Gemfile.</p>
<pre><code>gem "codemirror-rails"</code></pre>
<p>This gem adds all of the CodeMirror JavaScript and CSS assets to your
 Rails project. The next step is to ensure these dependencies are 
loaded. Since I’m using Haml, I’m going to load all of the necessary 
dependencies required for that particular language.</p>
<p>In application.js, add these dependencies:</p>
<pre><code>//= require codemirror
//= require codemirror/modes/xml
//= require codemirror/modes/htmlmixed
//= require codemirror/modes/javascript
//= require codemirror/modes/ruby
//= require codemirror/modes/haml</code></pre>
<p>The mode dependencies will rely on what you’re trying to show. Haml 
requires XML, HTMLMixed, JavaScript, Ruby, and Haml modes to work 
correctly.</p>
<p>Make sure you also load the CSS dependency into your application.css file (or application.css.scss):</p>
<pre><code>//= require codemirror</code></pre>
<p>Next, we need to add a place for CodeMirror to render. This is done 
using a textarea. In my case, I need the textarea to have a pre-existing
 entry, and since I’m using Haml, that presents a new issue. How can I 
prevent the Haml code from rendering? That’s where the <a href="http://haml.info/docs/yardoc/file.REFERENCE.html#preserve-filter">preserve filter</a> comes into play.</p>
<pre><code>%textarea#code{:name =&gt; "code"}
  :preserve
    // This is a four column grid 
    // Assign class names to the row element to achieve specificity

    .row.grid-haml-example.clearfix
      .large-4.columns
        %span 1 / 3
      .large-4.columns
        %span 1 / 3
        .row
          .large-6.columns
            Nested Column
          .large-6.columns
            Nested Column
      .large-4.columns
        %span 1 / 3</code></pre>
<p>Going back to our application.js file, we need to initialize CodeMirror. Per the <a href="http://codemirror.net/doc/manual.html">CodeMirror manual</a>, the script can be invoked with a variety of arguments:</p>
<pre><code>$("textarea").each(function() {
    CodeMirror.fromTextArea($(this).get(0), {
      lineNumbers: true,
      mode: "text/x-haml"
    });
  });</code></pre>
<p>I’ve customized my version of the code using jQuery. Since I have 
some pages that have multiple CodeMirror textareas, I need to use jQuery
 to loop through each textarea instance. I then pass the textarea’s 
class to CodeMirror using $(this).get(0). The arguments I’ve set for 
CodeMirror ensures I have line counts visible on the left margin and 
sets CodeMirror to text/x-haml mode.</p>
<p>That’s it! CodeMirror can be configured to work with an array of 
different languages. It’s a pretty powerful tool, especially for clearly
 showing markup and syntax.</p>
  </div>

      <a class="post_full-more" href="http://clecompte.com/blog/">
      See more posts <i class="fa fa-long-arrow-right" aria-hidden="true"></i>
    </a>
  </article>
          </main>
    </div>
        <footer class="footer">
  <div class="c_content">
    I'm available for work: <a href="mailto:clecompte@gmail.com">clecompte@gmail.com</a>
  </div>
</footer>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="Getting%20CodeMirror%20to%20Work%20With%20Ruby%20on%20Rails%20%E2%80%93%20Chris%20LeCompte_files/ga.js" type="text/javascript"></script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-7646905-1");
pageTracker._trackPageview();
} catch(err) {}</script>    <script type="text/javascript" src="Getting%20CodeMirror%20to%20Work%20With%20Ruby%20on%20Rails%20%E2%80%93%20Chris%20LeCompte_files/main_8eaed8b2.js"></script>
<script type="text/javascript" src="Getting%20CodeMirror%20to%20Work%20With%20Ruby%20on%20Rails%20%E2%80%93%20Chris%20LeCompte_files/wp-embed.js"></script>
  
</body></html>